{"ast":null,"code":"var _jsxFileName = \"/home/mark/repo/tailwind-deez/client/src/App.js\";\nimport React, { Component } from \"react\";\nimport { BrowserRouter as Router, Switch, Route } from \"react-router-dom\"; //import { Container, Typography } from \"@mui/material\"\n\nimport Deez from \"./contracts/Deez.json\";\nimport DeezExchanger from \"./contracts/DeezExchanger.json\";\nimport getWeb3 from \"./getWeb3\";\nimport NavBar from \"./NavBar\"; //import TransferForm from \"./TransferForm\"\n//import ExchangeForm from \"./ExchangeForm\"\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass App extends Component {\n  constructor() {\n    super();\n\n    this.componentDidMount = async () => {\n      const web3 = await getWeb3(); // Load deez\n\n      const netId = await web3.eth.net.getId();\n      const deployedNetwork = Deez.networks[netId];\n      const deezContract = new web3.eth.Contract(Deez.abi, deployedNetwork && deployedNetwork.address); // Load exchanger\n\n      const exchangerNetwork = DeezExchanger.networks[netId];\n      const exchangerContract = new web3.eth.Contract(DeezExchanger.abi, exchangerNetwork && exchangerNetwork.address);\n      this.setState({\n        web3,\n        deezContract,\n        exchangerContract\n      });\n    };\n\n    this.componentDidUpdate = async (prevProps, prevState) => {\n      if (prevState.account != this.state.account) await this.refreshBalance();\n    };\n\n    this.connectWallet = account => {\n      this.setState({\n        account: account\n      });\n    };\n\n    this.refreshBalance = async () => {\n      try {\n        const {\n          account,\n          deezContract\n        } = this.state;\n        const balance = await deezContract.methods.balanceOf(account).call();\n        this.setState({\n          balance: balance\n        });\n      } catch (e) {\n        console.error(e);\n      }\n    };\n\n    this.transferDeez = async (address, amount) => {\n      const {\n        account,\n        deezContract\n      } = this.state;\n      if (amount <= 0) return;\n      if (!account) return;\n      if (!this.state.web3.utils.isAddress(address)) return;\n      await deezContract.methods.transfer(address, amount).send({\n        from: account\n      });\n      await this.refreshBalance();\n    };\n\n    this.buyDeez = async amount => {\n      const {\n        account,\n        exchangerContract\n      } = this.state;\n      if (amount <= 0) return;\n      if (!account) return;\n      await exchangerContract.methods.buyDeez().send({\n        value: amount,\n        from: account\n      });\n      await this.refreshBalance();\n    };\n\n    this.sellDeez = async amount => {\n      const {\n        account,\n        deezContract,\n        exchangerContract\n      } = this.state;\n      if (amount <= 0) return;\n      if (!account) return;\n\n      if (this.state.balance < amount) {\n        alert(\"Insufficient balance\");\n        return;\n      }\n\n      await deezContract.methods.approve(exchangerContract._address, amount).send({\n        from: account\n      });\n      await exchangerContract.methods.sellDeez(amount).send({\n        from: account\n      });\n      await this.refreshBalance();\n    };\n\n    this.state = {\n      balance: 0,\n      web3: null,\n      account: null,\n      deezContract: null,\n      exchangerContract: null\n    };\n  }\n\n  render() {\n    /*\n    if (!this.state.web3) {\n      return <div>Loading Web3, accounts, and contracts...</div>;\n    }*/\n    return /*#__PURE__*/_jsxDEV(Router, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-96 mx-30 shadow-md\",\n        children: /*#__PURE__*/_jsxDEV(\"h5\", {\n          className: \"m-3\",\n          children: [\"Balance: \", this.state.balance]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(NavBar, {\n        state: this.state,\n        handleConnect: this.connectWallet\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/home/mark/repo/tailwind-deez/client/src/App.js"],"names":["React","Component","BrowserRouter","Router","Switch","Route","Deez","DeezExchanger","getWeb3","NavBar","App","constructor","componentDidMount","web3","netId","eth","net","getId","deployedNetwork","networks","deezContract","Contract","abi","address","exchangerNetwork","exchangerContract","setState","componentDidUpdate","prevProps","prevState","account","state","refreshBalance","connectWallet","balance","methods","balanceOf","call","e","console","error","transferDeez","amount","utils","isAddress","transfer","send","from","buyDeez","value","sellDeez","alert","approve","_address","render"],"mappings":"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","sourcesContent":["import React, {Component} from \"react\"\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route\n} from \"react-router-dom\"\n//import { Container, Typography } from \"@mui/material\"\nimport Deez from \"./contracts/Deez.json\"\nimport DeezExchanger from \"./contracts/DeezExchanger.json\"\nimport getWeb3 from \"./getWeb3\"\nimport NavBar from \"./NavBar\"\n//import TransferForm from \"./TransferForm\"\n//import ExchangeForm from \"./ExchangeForm\"\n\nclass App extends Component {\n  constructor() {\n    super();\n    this.state = { balance: 0, web3: null, account: null, deezContract: null, exchangerContract: null }\n  }\n\n  componentDidMount = async () => {\n    const web3 = await getWeb3()\n\n    // Load deez\n    const netId = await web3.eth.net.getId()\n    const deployedNetwork = Deez.networks[netId]\n    const deezContract = new web3.eth.Contract(\n      Deez.abi,\n      deployedNetwork && deployedNetwork.address\n    )\n\n    // Load exchanger\n    const exchangerNetwork = DeezExchanger.networks[netId]\n    const exchangerContract = new web3.eth.Contract(\n      DeezExchanger.abi,\n      exchangerNetwork && exchangerNetwork.address\n    )\n\n    this.setState({ web3, deezContract, exchangerContract })\n  }\n\n  componentDidUpdate = async (prevProps, prevState) => {\n    if (prevState.account != this.state.account) await this.refreshBalance()\n  }\n\n  connectWallet = (account) => {\n    this.setState({ account: account })\n  }\n\n  refreshBalance = async () => {\n    try {\n      const { account, deezContract } = this.state\n      const balance = await deezContract.methods.balanceOf(account).call()\n\n      this.setState({balance: balance})\n    } catch (e) {\n      console.error(e)\n    }\n  }\n\n  transferDeez = async (address, amount) => {\n    const { account, deezContract } = this.state\n    if (amount <= 0) return\n    if (!account) return\n    if (!this.state.web3.utils.isAddress(address)) return\n    await deezContract.methods.transfer(address, amount).send({ from: account })\n\n    await this.refreshBalance()\n  }\n\n  buyDeez = async (amount) => {\n    const { account, exchangerContract } = this.state\n    if (amount <= 0) return\n    if (!account) return\n    await exchangerContract.methods.buyDeez().send({ value: amount, from: account })\n\n    await this.refreshBalance()\n  }\n\n  sellDeez = async (amount) => {\n    const { account, deezContract, exchangerContract } = this.state\n    if (amount <= 0) return\n    if (!account) return\n    if (this.state.balance < amount) { alert(\"Insufficient balance\"); return }\n    await deezContract.methods.approve(exchangerContract._address, amount).send({ from: account })\n    await exchangerContract.methods.sellDeez(amount).send({ from: account })\n\n    await this.refreshBalance()\n  }\n\n  render() {\n    /*\n    if (!this.state.web3) {\n      return <div>Loading Web3, accounts, and contracts...</div>;\n    }*/\n    return (\n      <Router>\n        <div className=\"mt-96 mx-30 shadow-md\">\n          <h5 className=\"m-3\">Balance: {this.state.balance}</h5>\n        </div>\n        <NavBar state={this.state} handleConnect={this.connectWallet} />\n        \n        {/*\n        <Container\n          maxWidth=\"sm\"\n          sx={{ marginTop: \"30px\", display: 'flex', justifyContent:'center', alignItems:'center', boxShadow: 2 }}\n        >\n          <Switch>\n          <Route exact path=\"/\">\n            <TransferForm \n              state={this.state} \n              handleTransfer={this.transferDeez}\n              />\n          </Route>\n          <Route path=\"/exchange\">\n            <ExchangeForm\n            state={this.state}\n            handleBuy={this.buyDeez}\n            handleSell={this.sellDeez}\n            />\n          </Route>\n        </Switch>\n        </Container>\n        */}\n      </Router>\n    )\n  }\n}\n\nexport default App\n"]},"metadata":{},"sourceType":"module"}